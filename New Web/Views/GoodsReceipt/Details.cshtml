@model New_Web.Models.ViewModelGR

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Home {
    <h2 class="mb-3 mt-3"></h2> <!-- yield itu parameter dikirim ke page yg section nya title -->

    <div class="starter-template mt-3  shadow p-3 mb-2 bg-white rounded">
        <form action="@Url.Action("Line", "GoodsReceipt")" method="post">
            <div class="form-row">
                <div class="form-group col-md-2">
                    <label for="grcode">GR Code</label>
                    <input type="text" class="form-control" id="grcode" name="grcode" value="@Model.Status.GRCode" readonly>
                </div>


                <div class="form-group col-md-7">
                    <label for="itemcode">Item Code</label>
                    <select id="itemcode" class="form-control" name="itemcode">
                        @foreach (var item in Model.Item)
                        {
                            <option>@item.ItemCode - @item.Description</option>
                        }
                    </select>
                </div>
               
                

                <div class="form-group col-md-1">
                    <label for="quantity">Quantity</label>
                    <input type="text" class="form-control " id="quantity" placeholder="Qty" name="quantity" value="">                    
                </div>

                <div class="form-group col-md-2 pt-4 mt-1">
                    <button type="submit" class="btn btn-primary"><span class="mr-2" data-feather="plus"> </span>Add</button>
                </div>




            </div>

        </form>
    </div>
    <div class="table-responsive mt-3  shadow p-3 mb-5 bg-white rounded">
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th width="130px">Article Code</th>
                    <th width="270px">Description</th>
                    <th width="100px">Current Price</th>
                    <th width="60px">Quantity</th>
                    <th width="90px"></th>

                </tr>
            </thead>
            <tbody>
                @{int total = 0;
                    foreach (var item in Model.Detail)
                    {
                    <tr>
                        <td>@item.ItemCode</td>
                        <td>@item.Description</td>
                        <td>@Convert.ToDecimal(@item.CurrentPrice).ToString("N0")</td>
                        <td>@item.Quantity</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-default border btn-sm " type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <span data-feather="menu"></span>
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="@Url.Action("DeleteLine", "GoodsReceipt", new {itemcode = @item.ItemCode , grcode = @Model.Status.GRCode })"><span class="mr-2" data-feather="delete"></span>Delete</a>
                                </div>
                            </div>
                        </td>
                    </tr>
                        total += Convert.ToInt32(@item.Quantity);
                    }

                <tr>
                    <td colspan="3" class="font-weight-bold">Total</td>
                    <td class="font-weight-bold">
                        @total
                    </td>
                    <td></td>
                </tr>
                    }
            </tbody>
        </table>
    </div>
}



@section Scripts {

    @Scripts.Render("~/bundles/jqueryui")
    @Styles.Render("~/Content/cssjqryUi")



    <script type="text/javascript">


        $(document).ready(function () {
            $('input[type=datetime]').datepicker({
                dateFormat: "dd/MM/yy",
                changeMonth: true,
                changeYear: true,
                yearRange: "-60:+0",
            });
            var currentdate = new Date();

            $('input[type=datetime]').val($.datepicker.formatDate('dd/MM/yy', currentdate));
        });

        $('#docdate').change(function () {
            var date = new Date($('#docdate').val());
            $('#tgl').val(date.getDay());
            $('#bulan').val(date.getMonth() + 1);
            $('#tahun').val(date.getFullYear());
        });



    </script>

}
